<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Snake â€” Polished Classic</title>
  <style>
    html,body {
      margin:0; padding:0; height:100%; width:100%;
      background:black;
      color:lime;
      font-family:monospace;
      overflow:hidden;
    }
    #scoreboard {
      position:absolute; top:10px; left:10px;
      font-size:18px; font-weight:bold;
      text-shadow:0 0 6px lime;
    }
    canvas { display:block; }
    #message {
      position:absolute;
      top:50%; left:50%;
      transform:translate(-50%,-50%);
      color:lime;
      font-size:22px;
      font-weight:bold;
      display:none;
      text-align:center;
      text-shadow:0 0 10px lime;
    }
  </style>
</head>
<body>
  <div id="scoreboard">
    Score: <span id="score">0</span>  
    High: <span id="highscore">0</span>
  </div>
  <canvas id="game"></canvas>
  <div id="message"></div>

  <script>
  (function(){
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");
    const highEl = document.getElementById("highscore");
    const msgEl = document.getElementById("message");

    const CELL = 20;
    let COLS, ROWS;
    let snake, dir, nextDir, fruit, score, highScore, running, paused;
    let lastTime=0, speed=8, frameTime=0; // speed = moves per second

    function resize(){
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      COLS = Math.floor(canvas.width / CELL);
      ROWS = Math.floor(canvas.height / CELL);
    }
    window.addEventListener("resize", resize);
    resize();

    highScore = Number(localStorage.getItem("snakeHigh")) || 0;
    highEl.textContent = highScore;

    function randCell(){
      return { x: Math.floor(Math.random()*COLS), y: Math.floor(Math.random()*ROWS) };
    }

    function placeFruit(){
      let pos;
      const occ = new Set(snake.map(s=>s.x+","+s.y));
      do { pos = randCell(); } while(occ.has(pos.x+","+pos.y));
      fruit = pos;
    }

    function reset(){
      snake = [{x:Math.floor(COLS/2),y:Math.floor(ROWS/2)}];
      dir = {x:1,y:0}; nextDir = {x:1,y:0};
      score = 0; running = true; paused = false;
      placeFruit();
      scoreEl.textContent = score;
      msgEl.style.display="none";
      lastTime=0; frameTime=0;
      requestAnimationFrame(loop);
    }

    function gameOver(){
      running = false;
      if(score > highScore){
        highScore = score;
        localStorage.setItem("snakeHigh", highScore);
        highEl.textContent = highScore;
      }
      msgEl.innerHTML = `Game Over<br/>Score: ${score}<br/>Press Enter to Restart`;
      msgEl.style.display="block";
    }

    function loop(timestamp){
      if(!running) return;
      const delta = (timestamp - lastTime)/1000;
      lastTime = timestamp;
      if(!paused){
        frameTime += delta;
        if(frameTime >= 1/speed){
          frameTime = 0;
          tick();
        }
      }
      render();
      requestAnimationFrame(loop);
    }

    function tick(){
      if(!isOpposite(nextDir, dir)) dir = {...nextDir};
      const head = snake[0];
      const newHead = { x: head.x+dir.x, y: head.y+dir.y };

      if(newHead.x<0||newHead.x>=COLS||newHead.y<0||newHead.y>=ROWS) return gameOver();
      if(snake.some(s=>s.x===newHead.x && s.y===newHead.y)) return gameOver();

      snake.unshift(newHead);
      if(newHead.x===fruit.x && newHead.y===fruit.y){
        score++;
        scoreEl.textContent = score;
        placeFruit();
        // slightly increase speed
        speed = Math.min(16, speed + 0.2);
      } else {
        snake.pop();
      }
    }

    function render(){
      ctx.fillStyle="black";
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // fruit design: red circle with green leaf
      if(fruit){
        const fx = fruit.x*CELL+CELL/2;
        const fy = fruit.y*CELL+CELL/2;
        ctx.fillStyle="red";
        ctx.beginPath();
        ctx.arc(fx, fy, CELL/2-2, 0, Math.PI*2);
        ctx.fill();
        ctx.fillStyle="green";
        ctx.fillRect(fx-2, fy-CELL/2+2, 4, 6);
      }

      // snake: glowing green rounded rectangles
      for(let i=0;i<snake.length;i++){
        const s = snake[i];
        const x = s.x*CELL, y = s.y*CELL;
        ctx.fillStyle = i===0 ? "lime" : "#32cd32";
        ctx.shadowColor="lime";
        ctx.shadowBlur=8;
        roundRect(ctx,x+2,y+2,CELL-4,CELL-4,6,true);
      }
      ctx.shadowBlur=0;
    }

    function roundRect(ctx,x,y,w,h,r,fill){
      ctx.beginPath();
      ctx.moveTo(x+r,y);
      ctx.arcTo(x+w,y,x+w,y+h,r);
      ctx.arcTo(x+w,y+h,x,y+h,r);
      ctx.arcTo(x,y+h,x,y,r);
      ctx.arcTo(x,y,x+w,y,r);
      ctx.closePath();
      if(fill) ctx.fill();
    }

    function isOpposite(a,b){ return a.x===-b.x && a.y===-b.y; }

    window.addEventListener("keydown", e=>{
      const kd = {ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};
      if(kd[e.key]){
        const cand=kd[e.key];
        if(snake.length>1 && isOpposite(cand,dir)) return;
        nextDir=cand;
      }
      if(e.code==="Space"){ if(running) paused=!paused; }
      if(e.code==="Enter" && !running) reset();
    });

    reset();
  })();
  </script>
</body>
</html>
